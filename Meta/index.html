<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Meta â€” LOC stats</title>
  <link rel="stylesheet" href="../style.css" />
  <style>
    /* Slider styling */
    .slider-container {
      display: flex;
      align-items: baseline;
      flex: 1;
      margin-bottom: 20px;
    }

    .slider-container label {
      display: flex;
      align-items: baseline;
      gap: 10px;
      width: 100%;
    }

    .slider-container time {
      margin-left: auto;
      font-weight: bold;
      color: #333;
    }

    #commit-progress {
      flex: 1;
      margin: 0 10px;
    }

    /* CSS transitions for circles */
    circle {
      transition: all 200ms, r calc(var(--r) * 100ms);
    }

    @starting-style {
      circle {
        r: 0;
      }
    }

    /* File visualization styles */
    #files {
      display: grid;
      grid-template-columns: 1fr 4fr;
    }

    #files > div {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: subgrid;
    }

    #files dt {
      grid-column: 1;
    }

    #files dt small {
      display: block;
      font-size: 0.8em;
      opacity: 0.7;
      font-weight: normal;
    }

    #files dd {
      grid-column: 2;
      display: flex;
      flex-wrap: wrap;
      align-items: start;
      align-content: start;
      gap: 0.15em;
      padding-top: 0.6em;
      margin-left: 0;
    }

    .loc {
      display: flex;
      width: 0.5em;
      aspect-ratio: 1;
      background: var(--color, steelblue);
      border-radius: 50%;
    }

    /* Scrollytelling styles */
    #scrolly-1 {
      position: relative;
      display: flex;
      gap: 1rem;
    }

    #scrolly-1 > * {
      flex: 1;
    }

    #scatter-story {
      position: relative;
    }

    #scatter-story .step {
      padding-bottom: 70vh;
      opacity: 0.3;
      transition: opacity 300ms;
    }

    #scatter-story .step.is-active {
      opacity: 1;
    }

    #scatter-plot {
      position: sticky;
      top: 0;
      left: 0;
      bottom: auto;
      height: 50vh;
    }

    /* Tooltip styling */
    .tooltip {
      position: fixed;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px;
      border-radius: 5px;
      pointer-events: none;
      display: none;
      z-index: 1000;
      font-size: 14px;
    }

    .tooltip a {
      color: #88ccff;
    }
  </style>
</head>
<body>
  <main>
  <section id="stats-container">
    <h1>Repository summary</h1>
    <div id="stats"></div>
  </section>

  <!-- Time Slider -->
  <div class="slider-container">
    <label>
      Show commits until:
      <input type="range" id="commit-progress" min="0" max="100" value="100" />
      <time id="commit-time"></time>
    </label>
  </div>

  <!-- File visualization moved ABOVE scatterplot -->
  <section id="files-container">
    <h2>Files</h2>
    <dl id="files">
      <!-- File visualization will be rendered here -->
    </dl>
  </section>

  <!-- Scrollytelling section -->
  <div id="scrolly-1">
    <div id="scatter-story">
      <!-- Story steps will be generated here -->
    </div>
    <div id="scatter-plot">
      <section id="chart-container">
        <h2>Commits by time of day</h2>
        <svg id="scatterplot" width="800" height="500"></svg>
        <p id="selection-count">No commits selected</p>
        <dl id="language-breakdown" class="stats"></dl>
        <div id="tooltip" class="tooltip"></div>
      </section>
    </div>
  </div>

  <section id="debug">
    <h2>Console preview</h2>
    <pre id="preview"></pre>
  </section>
</main>
  <script src="../global.js" type="module"></script>
  <script type="module" src="main.js"></script>
</body>
</html>